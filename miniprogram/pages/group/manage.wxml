<!-- pages/group/manage.wxml -->
<view class="container">
  <!-- 统计信息 -->
  <view class="stats-card">
    <view class="stat-item">
      <text class="stat-number">{{stats.pendingCount}}</text>
      <text class="stat-label">待审核</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{stats.approvedCount}}</text>
      <text class="stat-label">已批准</text>
    </view>
  </view>

  <!-- 待审核成员列表 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">⏳ 待审核申请</text>
      <text class="section-subtitle">共 {{pendingMembers.length}} 个申请</text>
    </view>

    <view class="member-list">
      <view wx:for="{{pendingMembers}}" wx:key="_id" class="member-item pending">
        <image class="avatar" src="{{item.userInfo.avatarUrl}}"></image>
        <view class="member-info">
          <text class="member-name">{{item.userInfo.nickName}}</text>
          <text class="apply-time">申请时间: {{formatTime(item.applyTime)}}</text>
        </view>
        <view class="action-buttons">
          <button class="btn approve-btn" bindtap="onApprove" data-memberid="{{item._id}}">批准</button>
          <button class="btn reject-btn" bindtap="onReject" data-memberid="{{item._id}}">拒绝</button>
        </view>
      </view>

      <view wx:if="{{pendingMembers.length === 0}}" class="empty-state">
        <text class="empty-icon">✅</text>
        <text class="empty-text">暂无待审核申请</text>
        <text class="empty-subtext">所有申请已处理完毕</text>
      </view>
    </view>
  </view>

  <!-- 已批准成员列表 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">✅ 已批准成员</text>
      <text class="section-subtitle">共 {{approvedMembers.length}} 个成员</text>
    </view>

    <view class="member-list">
      <view wx:for="{{approvedMembers}}" wx:key="_id" class="member-item approved">
        <image class="avatar" src="{{item.userInfo.avatarUrl}}"></image>
        <view class="member-info">
          <text class="member-name">{{item.userInfo.nickName}}</text>
          <text class="member-role {{item.role}}">
            {{item.role === 'creator' ? '创建者' : '成员'}}
          </text>
          <text class="join-time">加入时间: {{formatTime(item.approvedTime)}}</text>
        </view>
        <view class="member-stats">
          <text class="stat">{{item.totalWordsLearned || 0}} 词</text>
          <text class="stat">{{Math.floor((item.totalStudyTime || 0)/60)}} 分钟</text>
        </view>
      </view>
    </view>
    <!-- 在已批准成员列表项中添加 -->
<view class="member-item" wx:for="{{approvedMembers}}" wx:key="_id">
  <view class="member-info">
    <image class="avatar" src="{{item.userInfo.avatarUrl}}"></image>
    <view class="member-details">
      <text class="member-name">{{item.userInfo.nickName}}</text>
      <text class="member-stats">单词: {{item.totalWordsLearned}} | 时长: {{Math.floor(item.totalStudyTime/60)}}分钟</text>
    </view>
  </view>
  
  <!-- 添加踢出按钮 -->
  <button 
    class="btn-remove" 
    bindtap="onRemoveMember" 
    data-userid="{{item.userId}}"
    data-username="{{item.userInfo.nickName}}"
    wx:if="{{item.role !== 'creator'}}"
  >
    移出
  </button>
</view>
  </view>
</view>